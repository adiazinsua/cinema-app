<ion-content>
  <ion-header collapse="condense">
    <!-- <ion-toolbar> -->
    <ion-title size="large" class="mt-3">Create account</ion-title>
    <!-- </ion-toolbar> -->
  </ion-header>
  <div class="ion-padding-horizontal mt-2">
    <ion-text class="desc-text subtitle"
      >Create your account to save and rate your favorites movies and share them
      with your friends!</ion-text
    >
  </div>

  <form class="form-container ion-padding mt-4" [formGroup]="form">
    <div>
      <ion-input
        labelPlacement="stacked"
        formControlName="email"
        fill="outline"
        placeholder="Enter your email"
        shape="round"
        mode="md"
      >
        <div slot="label">Email <ion-text color="danger">*</ion-text></div>
      </ion-input>
      <div
        class="error-message"
        *ngIf="form.controls['email'].touched && form.controls['email'].invalid"
      >
        <ion-text
          color="danger"
          *ngIf="form.controls['email'].errors?.['required']"
          >Email is required</ion-text
        >
        <ion-text
          color="danger"
          *ngIf="form.controls['email'].errors?.['email']"
          >Please enter a valid email</ion-text
        >
      </div>

      <ion-input
        class="mt-4"
        labelPlacement="stacked"
        formControlName="name"
        fill="outline"
        placeholder="Enter your name"
        shape="round"
        mode="md"
      >
        <div slot="label">Name <ion-text color="danger">*</ion-text></div>
      </ion-input>
      <div
        class="error-message"
        *ngIf="form.controls['name'].touched && form.controls['name'].errors?.['required']"
      >
        <ion-text color="danger">Name is required</ion-text>
      </div>

      <ion-input
        class="mt-4"
        labelPlacement="stacked"
        formControlName="password"
        fill="outline"
        placeholder="Enter your password"
        shape="round"
        mode="md"
        type="password"
      >
        <div slot="label">Password <ion-text color="danger">*</ion-text></div>
        <ion-input-password-toggle
          slot="end"
          color="light"
        ></ion-input-password-toggle>
      </ion-input>
      <div
        class="error-message"
        *ngIf="form.controls['password'].touched && form.controls['password'].errors?.['required']"
      >
        <ion-text color="danger">Password is required</ion-text>
      </div>
      @if (showPasswordRequirements) {
      <div class="conditions">
        <ion-row class="ion-align-items-center">
          <ion-icon
            name="checkmark-circle"
            [color]="passwordTestRegex(specialCharRegex) ? 'success' : 'gray'"
          ></ion-icon>
          <span class="ml-0-5">At least one special character</span>
        </ion-row>
        <ion-row class="ion-align-items-center">
          <ion-icon
            name="checkmark-circle"
            [color]="passwordTestRegex(uppercaseRegex) ? 'success' : 'gray'"
          ></ion-icon>
          <span class="ml-0-5">At least one uppercase character</span>
        </ion-row>
        <ion-row class="ion-align-items-center">
          <ion-icon
            name="checkmark-circle"
            [color]="passwordTestRegex(lowercaseRegex) ? 'success' : 'gray'"
          ></ion-icon>
          <span class="ml-0-5">At least one lowercase character</span>
        </ion-row>
        <ion-row class="ion-align-items-center">
          <ion-icon
            name="checkmark-circle"
            [color]="passwordTestRegex(lengthRegex) ? 'success' : 'gray'"
          ></ion-icon>
          <span class="ml-0-5">Minimun 8 characters long</span>
        </ion-row>
      </div>
      }

      <ion-input
        class="mt-4"
        labelPlacement="stacked"
        formControlName="confirmPassword"
        fill="outline"
        placeholder="Repeat your password"
        shape="round"
        mode="md"
        type="password"
      >
        <div slot="label">
          Confirm password <ion-text color="danger">*</ion-text>
        </div>
        <ion-input-password-toggle
          slot="end"
          color="light"
        ></ion-input-password-toggle>
      </ion-input>
      <div
        class="error-message"
        *ngIf="form.controls['confirmPassword'].touched && form.invalid"
      >
        <ion-text
          color="danger"
          *ngIf="form.controls['confirmPassword'].errors?.['required']"
          >Repeat your password</ion-text
        >
        <ion-text color="danger" *ngIf="form.errors?.['passwordMismatch']"
          >Passwords don't match</ion-text
        >
      </div>
    </div>
    <div>
      <ion-button
        class="btn-block mt-5"
        shape="round"
        color="primary"
        (click)="create()"
        [disabled]="!shouldEnableCreateBtn"
      >
        Create account
      </ion-button>

      <ion-button class="btn-block" fill="clear" (click)="redirectToLogin()">
        Already have an account? Log in
      </ion-button>
    </div>
  </form>
</ion-content>
